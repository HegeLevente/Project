<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>JS Shopping Cart</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css">
  <link rel='stylesheet' href='https://cdn.jsdelivr.net/foundation/5.0.2/css/foundation.css'>
  <link rel="stylesheet" href="style.css">

</head>
<body>

<div class="row">
    <nav class="top-bar" data-topbar>
        <ul class="title-area">
            <li class="name">
                <h1><a href="#">JavsScript Kosár - EJS template használatával</a></h1>
            </li>
        </ul>
    </nav>
    <div class="medium-4  columns">
        <div class="cart">
            <h1>Kosár</h1>
            <div class="row">
                <div class="medium-6 columns">
                    <button class="tiny secondary" onclick="cart.clearItems();">Kosár kiűrítése</button>
                </div>
                <div class="medium-6 columns">
                    <button class="tiny" onclick="javascript:megrendel();" title="Work in progress">Megrendelés</button>
                </div>
            </div>
            <div id="cartItems">Kosár adatainak betöltése...</div>
            Összesen fizetendő: <strong id="totalPrice">0 Ft.</strong>
        </div>
      
    </div>
    <div class="medium-8 columns">
        <h1>Termékek</h1>
        <div class="products">
            <div class="product medium-4 columns" data-name="Vivobook" data-price="50000" data-id="0">
                <img src="https://webdevtrick.com/wp-content/uploads/vivobook.jpg" alt="" />
                <h3>Vivobook</h3>
                <input type="number" class="count" value="1" />
                <button class="tiny" onclick='cart.addItem({"id":"0","name":"Vivobook","price":"50000","count":"1","total":50000})'>Kosárba</button>
            </div>
            <div class="product medium-4 columns" >
                <img src="https://webdevtrick.com/wp-content/uploads/surface.jpg" alt="" />
                <h3>Surface Pro</h3>
                <input type="number" class="count" value="1" />
                <button class="tiny" onclick='cart.addItem({"id":"1","name":"Surface Pro","price":"85000","count":"1","total":85000});'>Kosárba</button>
            </div>
            <div class="product medium-4 columns">
                <img src="https://webdevtrick.com/wp-content/uploads/predator.jpg" alt="" />
                <h3>Predator</h3>
                <input type="number" class="count" value="1" />
                <button class="tiny" onclick='cart.addItem({"id":"2","name":"Predator","price":"250000","count":"1","total":250000});'>Kosárba</button>
            </div>
        </div>
    </div>
</div>

<script type="text/template" id="cartT">
          <% items.forEach(function(item) {%>
			<div class = "panel"> <h3> <%= item.name %> </h3>  
			 <span class="label">
				<%= item.count %> db.
				<%= item.total %> Ft.
			 </span > 
			</div>
          <%}); %>

</script>

<script>
function XXmegrendel()
{
    let cardData = storage.getCartStr();
    alert(cardData);

    async function postData(url = '', data = cardData) {
  // Default options are marked with *
  const response = await fetch(url, {
    method: 'POST', // *GET, POST, PUT, DELETE, etc.
    mode: 'cors', // no-cors, *cors, same-origin
    cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached
    credentials: 'same-origin', // include, *same-origin, omit
    headers: {
      'Content-Type': 'application/json'
      // 'Content-Type': 'application/x-www-form-urlencoded',
    },
    redirect: 'follow', // manual, *follow, error
    referrerPolicy: 'no-referrer', // no-referrer, *no-referrer-when-downgrade, origin, origin-when-cross-origin, same-origin, strict-origin, strict-origin-when-cross-origin, unsafe-url
    body: JSON.stringify(data) // body data type must match "Content-Type" header
  });
  return response.json(); // parses JSON response into native JavaScript objects
}


postData('http://localhost/megrendel', cardData)
  .then(data => {
    console.log(data); // JSON data parsed by `data.json()` call
  });
}

function megrendel()
{
const data = { username: 'example' };
const cardData = storage.getCartStr();
fetch('/megrendel', {
  method: 'POST', // or 'PUT'
  headers: {
    'Content-Type': 'application/json',
  },
  body: JSON.stringify(storage.getCart()),
})
.then(response => response.json())
.then(data => {
  console.log('Success:', data);
})
}

</script>  



<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
<script src="ejs.min.js"></script>
<script  src="kosar.js"></script>

</body>
</html>
